{% extends "tours/base.html" %}
{% load staticfiles %}
{% block content %}
<style type="text/css">
  #loading{
    position: absolute;
    top: calc(50vh - 120px);
    left: calc(50% - 150px);
    width: 300px;
    height: 240px;
    z-index: -9999;
  }
</style>
<div id="map"></div>
<img src="{% static 'img/spinner.gif' %}" id="loading">
{% endblock %}

{% block javascript %}
<script>
function getLocation() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(myMap, showError);
    } else {
        x.innerHTML = "Geolocation is not supported by this browser.";
    }
}

function myMap(position) {
var myLatLng = {lat: position.coords.latitude, lng: position.coords.longitude};

var map = new google.maps.Map(document.getElementById('map'), {
          center: {lat: position.coords.latitude, lng: position.coords.longitude},
          zoom: 17,
          mapTypeControlOptions: {
            mapTypeIds: ['satellite']
          }
        });

var image = {
    url: "http://www.stlouisscottierescue.com/Scottie_sill_trans.gif", // url
    scaledSize: new google.maps.Size(50, 50), // scaled size
    origin: new google.maps.Point(0,0), // origin
    anchor: new google.maps.Point(25, 25) // anchor
};

{% for location in locations %}
	var location_marker = new google.maps.Marker({
		position: new google.maps.LatLng(parseFloat({{location.latitude}}),parseFloat({{location.longitude}})),
	    map: map,
	    title: '{{location.name}}',
	});
{% endfor %}

var marker = new google.maps.Marker({
          position: myLatLng,
          map: map,
          title: 'Current Location',
          icon: image
        });



}

</script>
<!-- Google Maps API -->
<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBcW3Bs3eY07QCJj3_yR7p0ISiyPxg3mz0&callback=getLocation"
  type="text/javascript"></script>
{% endblock %}